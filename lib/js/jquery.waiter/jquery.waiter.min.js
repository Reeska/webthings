!function(e){function n(e,n,t,i,a,c){this.checkingUrl=e,this.tokenParam=n,this.form=t,this.token=i,this.callback=a,this.startTime=c,this.config={},this.config[n]=i}n.prototype.check=function(){var n=this;setTimeout(function(){e.ajax({dataType:"json",url:n.checkingUrl,data:n.config,cache:!1}).success(function(e){if(e){var t=(new Date).getTime();n.callback(n.form,n.token,t,t-n.startTime)}else n.check()}).fail(function(){window.console&&console.error("Une erreur est survenue lors de l'appel AJAX de :"+n.checkingUrl)})},1e3)},e.fn.waiter=function(t){var t=e.extend({checkingUrl:window.location,initCallback:function(e,n,t){},endCallback:function(e,n,t,i){},tokenField:"_token",tokenParam:"token"},t);return e(this).submit(function(){var i=Math.random()+(new Date).getTime(),a=e('[name="'+t.tokenField+'"]',this);a.length?a.val(i):e('<input type="hidden" name="'+t.tokenField+'" value="'+i+'" />').appendTo(this);var c=(new Date).getTime(),o=new n(t.checkingUrl,t.tokenParam,this,i,t.endCallback,c);t.initCallback(this,i,c),o.check()})}}(jQuery);